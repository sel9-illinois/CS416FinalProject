<!DOCTYPE html>
<meta charset="utf-8">
<script src="//d3js.org/d3.v3.min.js"></script>

<head>
  <title>Narrative Visualization for Dog Breeds</title>
</head>

<h1>The following charts compare the average height of a range of dog breeds with respect to their average life expectancy.</h1>
<h2>The charts are displayed beginning with all breed sizes, followed by small, medium, large respectively. Once you reach the end, the sequence begins again.</h2>


</p><button onclick="nextBreedData()" class="button1">Next Breed Data</button></p>



<style>

body {
  font: 10px sans-serif;
}
	
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.dot {
  stroke: #000;
}

#tooltip {
opacity: 0;
position: absolute; 
text-align: center;
width: 150px; height: 50px; 
background: yellow;
border: 0px;
}

</style>
<body>
<div id="tooltip"></div>
	
<script>

var allBreedAnnotation1 = "1. This scene shows the average height of a given dog breed with respect to its expected average life expectancy for all sizes of dog breeds. As you can see in the plot, the life expectancy tends to decrease the larger the dog gets."
var allBreedAnnotation2 = "As you can see in the plot, the life expectancy tends to decrease the larger the dog gets."

var smallBreedAnnotation1 = "2. This scene shows the average height and life expectancy for small dogs which includes anything shorter than 15 in."
var smallBreedAnnotation2 = "You can see that all small dogs tend to live longer than the average for all dogs. All small dog breeds tend to live longer than 10 years and as long as 20 years."

var mediumBreedAnnotation1 = "This scene shows the average height and life expectancy for medium dogs which includes anything in the range of 15 in to 22 in."
var mediumBreedAnnotation2 = "You can see that most medium dogs tend to live the average years for all dogs. All medium dog breeds tend to live longer than 8 years and as long as 16 years."

var largeBreedAnnotation1 = "This scene shows the average height and life expectancy for large dogs which includes anything taller than 22 in."
var largeBreedAnnotation2 = "You can see that all large dogs tend to live shorter than the average for all dogs. All large dog breeds tend to live longer than 6 years and as long as 15 years."

function replaceButton(){
	var button = document.getElementById("hideButton");
  	button.remove();
}

var breedCount = 1; //0 - total, 1 - small, 2 - medium, 3 - large
var csvFile;
var note1;
var note2;
	
function nextBreedData() {
	if(breedCount == 0){
		csvFile = "dog_breeds.csv";
		note1 = allBreedAnnotation1;
		note2 = allBreedAnnotation2;
		breedCount++;
	} else if(breedCount == 1){
		csvFile = "small_dog_breeds.csv";
		note1 = smallBreedAnnotation1;
		note2 = smallBreedAnnotation2;
		breedCount++;
	} else if(breedCount == 2){
		csvFile = "medium_dog_breeds.csv";
		note1 = mediumBreedAnnotation1;
		note2 = mediumBreedAnnotation2;
		breedCount++;
	} else if(breedCount == 3){
		csvFile = "large_dog_breeds.csv";
		note1 = largeBreedAnnotation1;
		note2 = largeBreedAnnotation2;
		breedCount = 0;
	}
	removeChart();
	createChart(csvFile,note1,note2);
}

function removeButton() {
  var button = document.getElementById("seeButton");
  button.remove();
}
	
function mediumDogNext() {
	removeChart();
	getElementById("step3");
	createChart("medium_dog_breeds.csv");
}

var tooltip = d3.select("#tooltip");
	
var margin = {top: 50, right: 150, bottom: 40, left: 60};
var width = 1120 - margin.left - margin.right;
var height = 580 - margin.top - margin.bottom;

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	

function createChart(dataFile, annotation1, annotation2) {
		
    d3.csv(dataFile, function(error, data) {
	if (error) throw error;

    svg.append("text")
	.attr("class", "label")
	.attr("y", -20)
	.style("text-anchor", "start")
	.text(annotation1);

    svg.append("text")
	.attr("class", "label")
	.attr("y", -10)
	.style("text-anchor", "start")
	.text(annotation2);

	var x = d3.scale.linear()
	    .range([0, width]);
	
	var y = d3.scale.linear()
	    .range([height, 0]);
	
	var color = d3.scale.category10();

	    	var xAxis = d3.svg.axis()
	  .scale(x)
	 .orient("bottom");
	
	var yAxis = d3.svg.axis()
	 .scale(y)
	.orient("left");
	    
    data.forEach(function(d) {
      d.AverageHeight = +d.AverageHeight;
      d.AverageLongevity = +d.AverageLongevity;
    });

	    
    x.domain(d3.extent(data, function(d) { return d.AverageHeight; })).nice();
    y.domain(d3.extent(data, function(d) { return d.AverageLongevity; })).nice();

	    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis)
      .append("text")
        .attr("class", "label")
        .attr("x", width)
        .attr("y", 30)
        .style("text-anchor", "end")
        .text("Average Height (in)");
  
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
      .append("text")
        .attr("class", "label")
        .attr("transform", "rotate(-90)")
        .attr("y", -45)
        .attr("dy", ".71em")
        .style("text-anchor", "end ")
        .text("Life Expectancy (years)")
	    
    svg.selectAll(".dot")
        .data(data)
      .enter().append("circle")
        .attr("class", "dot")
        .attr("r", 8)
        .attr("cx", function(d) { return x(d.AverageHeight); })
        .attr("cy", function(d) { return y(d.AverageLongevity); })
        .style("fill", function(d) { return color(d.Breed); })
        .on("mouseover", function(d, i) { 
          tooltip.style("opacity", 1)
            .style("left", (d3.event.pageX)+"px")
            .style("top", (d3.event.pageY)+"px")
            .html("The " + d.Breed + " breed can be between " + d.MinHeight + "-" + d.MaxHeight + " inches in height and live between " + d.MinLongevity + "-" + d.MaxLongevity + " years." );
      })
      .on("mouseout", function() { tooltip.style("opacity", 0) });
	});
}

	

	

function removeChart(){
	//document.body.innerHTML="";
	//d3.select("h1").remove();
	//d3.select("p1").remove();
	//d3.select("p2").remove();
	d3.selectAll(".dot").remove();
	//d3.selectAll("g").remove();
	d3.select("text").remove();
}

createChart("dog_breeds.csv",allBreedAnnotation1,allBreedAnnotation2);


</script>
